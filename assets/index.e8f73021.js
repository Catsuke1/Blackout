var ke=Object.defineProperty;var ve=(o,e,s)=>e in o?ke(o,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):o[e]=s;var v=(o,e,s)=>(ve(o,typeof e!="symbol"?e+"":e,s),s);import{P as Ce,w as te,S as I,i as $,s as G,e as C,t as D,a as E,b as ne,c as w,d as q,f as O,g as k,n as A,h as M,j as ye,k as T,u as qe,l as S,m as P,o as Se,p as z,q as ie,r as L,v as Q,x as R,y as re,z as K,A as j,B as Te,C as U,D as Y,E as X,F,G as Pe,H as le,I as Ae,J as Ee}from"./vendor.45e29171.js";const Be=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))n(t);new MutationObserver(t=>{for(const i of t)if(i.type==="childList")for(const r of i.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&n(r)}).observe(document,{childList:!0,subtree:!0});function s(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerpolicy&&(i.referrerPolicy=t.referrerpolicy),t.crossorigin==="use-credentials"?i.credentials="include":t.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(t){if(t.ep)return;t.ep=!0;const i=s(t);fetch(t.href,i)}};Be();function ce(o,e){for(let s=0;s<o.length;s++)for(let n=0;n<o[s].length;n++)e(o[s][n],s,n)}function ae(o,e,s){const n=new Array(o);for(let t=0;t<o;t++){n[t]=new Array(e);for(let i=0;i<e;i++)n[t][i]=s}return n}class se{constructor(e,s){this.row=e,this.column=s}static isEqual(e,s){return e.row===s.row&&e.column===s.column}}function H(o,e){return new se(o,e)}var y;(function(o){o[o.Empty=0]="Empty",o[o.WhitePiece=1]="WhitePiece",o[o.BlackPiece=2]="BlackPiece",o[o.Card=3]="Card"})(y||(y={}));class De{constructor(e,s){v(this,"rows");v(this,"columns");v(this,"squareTypes");this.rows=e,this.columns=s,this.squareTypes=ae(e,s,y.Empty)}getTypeAt(e){return this.squareTypes[e.row][e.column]}setSquareType(e,s){this.squareTypes[e.row][e.column]=s}forEachSquareType(e){ce(this.squareTypes,(s,n,t)=>{e(s,H(n,t))})}movePiece(e,s){this.setSquareType(s,this.getTypeAt(e)),this.setSquareType(e,y.Empty)}getQueenPositions(){const e={white:[],black:[]};return this.forEachSquareType((s,n)=>{s===y.WhitePiece?e.white.push(n):s===y.BlackPiece&&e.black.push(n)}),e}}function He(o,e){for(const s of e)if(o.row===s.row&&o.column===s.column)return!0;return!1}function oe(o,e){const s=[];for(let n=e.row-1;n>-1;n--){const t=H(n,e.column);if(o.getTypeAt(t)!==y.Empty)break;s.push(t)}for(let n=e.row+1;n<o.rows;n++){const t=H(n,e.column);if(o.getTypeAt(t)!==y.Empty)break;s.push(t)}for(let n=e.column-1;n>-1;n--){const t=H(e.row,n);if(o.getTypeAt(t)!==y.Empty)break;s.push(t)}for(let n=e.column+1;n<o.columns;n++){const t=H(e.row,n);if(o.getTypeAt(t)!==y.Empty)break;s.push(t)}for(let n=e.row-1,t=e.column-1;n>-1&&t>-1;n--,t--){const i=H(n,t);if(o.getTypeAt(i)!==y.Empty)break;s.push(i)}for(let n=e.row-1,t=e.column+1;n>-1&&t<o.columns;n--,t++){const i=H(n,t);if(o.getTypeAt(i)!==y.Empty)break;s.push(i)}for(let n=e.row+1,t=e.column-1;n<o.rows&&t>-1;n++,t--){const i=H(n,t);if(o.getTypeAt(i)!==y.Empty)break;s.push(i)}for(let n=e.row+1,t=e.column+1;n<o.rows&&t<o.columns;n++,t++){const i=H(n,t);if(o.getTypeAt(i)!==y.Empty)break;s.push(i)}return s}var B;(function(o){o[o.White=0]="White",o[o.Black=1]="Black"})(B||(B={}));var N;(function(o){o[o.Piece=0]="Piece",o[o.Card=1]="Card"})(N||(N={}));class Ie{constructor(e){v(this,"gameSettings");v(this,"boardData");v(this,"turn",{color:void 0,action:void 0});v(this,"winner");this.gameSettings=e,this.reset()}get(){return{board:this.boardData.squareTypes,turn:this.turn}}set(e){this.boardData.squareTypes=e.board,this.turn=e.turn}reset(){this.boardData=new De(this.gameSettings.rows,this.gameSettings.columns);for(const e of this.gameSettings.start.pieces.white)this.boardData.setSquareType(e,y.WhitePiece);for(const e of this.gameSettings.start.pieces.black)this.boardData.setSquareType(e,y.BlackPiece);this.turn.color=this.gameSettings.start.color,this.turn.action=this.gameSettings.start.action,this.winner=this.getWinner()}nextTurn(){this.turn.color=this.turn.color===1?0:1,this.turn.color===this.gameSettings.start.color&&(this.turn.action=this.turn.action===1?0:1),this.winner=this.getWinner()}getWinner(){const e=this.boardData.getQueenPositions();let s=!0,n=!0;for(const t of e.white)if(oe(this.boardData,t).length!==0){s=!1;break}for(const t of e.black)if(oe(this.boardData,t).length!==0){n=!1;break}return s&&n?this.turn.color===0?1:0:s?1:n?0:null}}class $e{constructor(e){v(this,"dataConnection");v(this,"id");v(this,"metadata");v(this,"label");v(this,"reliable");this.dataConnection=e,this.id=this.dataConnection.peer,this.metadata=this.dataConnection.metadata,this.label=this.dataConnection.label,this.reliable=this.dataConnection.reliable}async open(){return await new Promise((e,s)=>{this.dataConnection.on("open",()=>{e()}),this.dataConnection.on("error",n=>{s(n)})})}getDataConnection(){return this.dataConnection}isOpen(){return this.dataConnection.open}close(){this.dataConnection.close()}send(e){this.dataConnection.send(e)}}function Ge(o,e,s,n,t,i){return{rows:o,columns:e,start:{pieces:{white:s.map(r=>H(r[0],r[1])),black:n.map(r=>H(r[0],r[1]))},color:t,action:i}}}class Me{constructor(){v(this,"connections");this.connections={}}add(e){this.connections[e.id]=e}remove(e){delete this.connections[e.id]}get(e){return this.connections[e]}getAll(){return Object.values(this.connections)}removeAll(){this.connections={}}count(){return Object.values(this.connections).length}}class We{constructor(e){v(this,"me");v(this,"list");v(this,"recievers");this.me=e,this.list=new Me,this.recievers=[]}setupDataConnection(e){e.getDataConnection().on("data",s=>{for(const n of this.recievers)n(s,e.id)}),e.getDataConnection().on("close",()=>{this.list.remove(e)}),e.getDataConnection().on("error",s=>{this.list.remove(e)})}async addConnection(e){const s=new $e(e);return await s.open(),this.setupDataConnection(s),this.list.add(s),s}async connect(e,s){const n=this.me.connect(e,s);return await this.addConnection(n)}disconnect(e){const s=this.list.get(e);s.close(),this.list.remove(s)}disconnectAll(){this.list.getAll().forEach(e=>{e.close()}),this.list.removeAll()}send(e,...s){s.forEach(n=>{const t=this.list.get(n);t!==void 0&&(t.isOpen()?t.send(e):this.list.remove(t))})}sendAll(e){this.list.getAll().forEach(s=>{s.isOpen()?s.send(e):this.list.remove(s)})}}class ze{constructor(e){v(this,"me");v(this,"connectionClient");v(this,"id");this.me=new Ce(void 0,e),this.connectionClient=new We(this.me),this.me.on("close",()=>{this.connectionClient.disconnectAll()}),this.me.on("disconnected",()=>{this.id=void 0}),this.me.on("error",s=>{this.id=void 0,this.connectionClient.disconnectAll()}),this.me.on("connection",async s=>{const n=await this.connectionClient.addConnection(s);this.remoteConnection(n)})}async open(){return await new Promise((e,s)=>{this.me.on("open",n=>{this.id=n,e(n)})})}getPeer(){return this.me}disconnect(){this.me.disconnect()}destroy(){this.me.destroy()}isDisconnected(){return this.me.disconnected}isDestroyed(){return this.me.destroyed}remoteConnection(e){}}var V;(function(o){o[o.Me=0]="Me",o[o.Them=1]="Them"})(V||(V={}));class Le{constructor(){v(this,"connectionId");v(this,"connected");v(this,"myColor");v(this,"newGameRequest");this.connectionId=void 0,this.connected=!1,this.myColor=void 0,this.newGameRequest=void 0}setupConnection(e,s){this.connectionId=e.id,this.connected=!0,this.myColor=s}closeConnection(){this.connectionId=void 0,this.connected=!1,this.myColor=void 0,this.newGameRequest=void 0}requestNewGame(e){return console.log("new game request by",e),this.newGameRequest===void 0?(this.newGameRequest=e,!1):e!==this.newGameRequest?(this.newGameRequest=void 0,!0):!1}}const Re=Ge(8,8,[[0,2],[0,4]],[[7,3],[7,5]],B.White,N.Piece),W=te(new Ie(Re)),Z=te(new ze),x=te(new Le);function ue(o){let e,s,n=o[0].connectionId+"",t,i,r,c,l=(o[0].myColor===B.White?"white":"black")+"",a,d,f,p,m=o[2]&&fe(o);return{c(){e=C("p"),s=D("Connected to "),t=D(n),i=E(),r=C("p"),c=D("You are "),a=D(l),d=D("."),f=E(),m&&m.c(),p=ne()},m(u,b){w(u,e,b),q(e,s),q(e,t),w(u,i,b),w(u,r,b),q(r,c),q(r,a),q(r,d),w(u,f,b),m&&m.m(u,b),w(u,p,b)},p(u,b){b&1&&n!==(n=u[0].connectionId+"")&&O(t,n),b&1&&l!==(l=(u[0].myColor===B.White?"white":"black")+"")&&O(a,l),u[2]?m?m.p(u,b):(m=fe(u),m.c(),m.m(p.parentNode,p)):m&&(m.d(1),m=null)},d(u){u&&k(e),u&&k(i),u&&k(r),u&&k(f),m&&m.d(u),u&&k(p)}}}function fe(o){let e,s,n;return{c(){e=C("p"),s=D(o[1]),n=D(" (1/2)")},m(t,i){w(t,e,i),q(e,s),q(e,n)},p(t,i){i&2&&O(s,t[1])},d(t){t&&k(e)}}}function Ne(o){let e,s=o[0].connected&&ue(o);return{c(){s&&s.c(),e=ne()},m(n,t){s&&s.m(n,t),w(n,e,t)},p(n,[t]){n[0].connected?s?s.p(n,t):(s=ue(n),s.c(),s.m(e.parentNode,e)):s&&(s.d(1),s=null)},i:A,o:A,d(n){s&&s.d(n),n&&k(e)}}}function Oe(o,e,s){let n,t,i;return M(o,x,r=>s(0,i=r)),o.$$.update=()=>{o.$$.dirty&1&&s(2,n=i.newGameRequest!==void 0),o.$$.dirty&1&&s(1,t=(()=>i.newGameRequest===V.Me?"Requesting a new game":i.newGameRequest===V.Them?"Opponent is requesting a new game":"")())},[i,t,n]}class xe extends I{constructor(e){super();$(this,e,Oe,Ne,G,{})}}function Qe(o){return{c:A,m:A,p:A,i:A,o:A,d:A}}function je(o){let e,s,n,t=o[7]+"",i,r,c,l,a,d,f,p,m,u,b,g;return m=new xe({}),{c(){e=C("p"),e.textContent="Created peer with id:",s=E(),n=C("pre"),i=D(t),r=E(),c=C("label"),c.textContent="Connection ID",l=E(),a=C("input"),d=E(),f=C("button"),f.textContent="Connect",p=E(),z(m.$$.fragment),T(c,"for","connectionId"),T(a,"type","text"),T(a,"id","connectionId"),T(f,"type","button")},m(h,_){w(h,e,_),w(h,s,_),w(h,n,_),q(n,i),w(h,r,_),w(h,c,_),w(h,l,_),w(h,a,_),ie(a,o[0]),w(h,d,_),w(h,f,_),w(h,p,_),L(m,h,_),u=!0,b||(g=[Q(a,"input",o[3]),Q(f,"click",o[2])],b=!0)},p(h,_){_&1&&a.value!==h[0]&&ie(a,h[0])},i(h){u||(S(m.$$.fragment,h),u=!0)},o(h){P(m.$$.fragment,h),u=!1},d(h){h&&k(e),h&&k(s),h&&k(n),h&&k(r),h&&k(c),h&&k(l),h&&k(a),h&&k(d),h&&k(f),h&&k(p),R(m,h),b=!1,re(g)}}}function Ve(o){let e;return{c(){e=C("p"),e.textContent="Creating peer..."},m(s,n){w(s,e,n)},p:A,i:A,o:A,d(s){s&&k(e)}}}function Fe(o){let e,s,n={ctx:o,current:null,token:null,hasCatch:!1,pending:Ve,then:je,catch:Qe,value:7,blocks:[,,,]};return ye(o[1],n),{c(){e=C("div"),n.block.c(),T(e,"class","panelContainer svelte-1wa81jg")},m(t,i){w(t,e,i),n.block.m(e,n.anchor=null),n.mount=()=>e,n.anchor=null,s=!0},p(t,[i]){o=t,qe(n,o,i)},i(t){s||(S(n.block),s=!0)},o(t){for(let i=0;i<3;i+=1){const r=n.blocks[i];P(r)}s=!1},d(t){t&&k(e),n.block.d(),n.token=null,n=null}}}function Je(o,e,s){let n;M(o,Z,a=>s(6,n=a));let t=n.open(),i="",r;Se(Z,n.remoteConnection=a=>{r=a,x.update(d=>(d.setupConnection(r,B.Black),d)),W.update(d=>(d.reset(),d))},n);const c=async()=>{try{r=await n.connectionClient.connect(i)}catch{console.log("failed to connect!");return}x.update(a=>(a.setupConnection(r,B.White),a)),W.update(a=>(a.reset(),a))};function l(){i=this.value,s(0,i)}return[i,t,c,l]}class Ke extends I{constructor(e){super();$(this,e,Je,Fe,G,{})}}function Ue(o){let e,s,n,t;return{c(){e=C("div"),s=D(o[2]),T(e,"class","square svelte-1tz948c"),K(e,"--squareSize",o[1]+"rem"),j(e,"black",o[0].isBlack),j(e,"highlight",o[3]),j(e,"card",o[4])},m(i,r){w(i,e,r),q(e,s),n||(t=Q(e,"click",o[5]),n=!0)},p(i,[r]){r&4&&O(s,i[2]),r&2&&K(e,"--squareSize",i[1]+"rem"),r&1&&j(e,"black",i[0].isBlack),r&8&&j(e,"highlight",i[3]),r&16&&j(e,"card",i[4])},i:A,o:A,d(i){i&&k(e),n=!1,t()}}}function Ye(o,e,s){let n,t;M(o,W,u=>s(8,t=u));let{squareData:i}=e,{squareSize:r=5}=e,c="",l=!1,a=!1;const d=u=>{s(3,l=u)},f=u=>{switch(s(4,a=u===y.Card),u){case y.Empty:case y.Card:s(2,c="");break;case y.WhitePiece:s(2,c="\u2655");break;case y.BlackPiece:s(2,c="\u265B");break}return u},p=Te(),m=()=>{p("square-click",{position:H(i.row,i.column),squareType:n})};return o.$$set=u=>{"squareData"in u&&s(0,i=u.squareData),"squareSize"in u&&s(1,r=u.squareSize)},o.$$.update=()=>{o.$$.dirty&257&&(n=f(t.boardData.squareTypes[i.row][i.column]))},[i,r,c,l,a,m,d,f,t]}class Xe extends I{constructor(e){super();$(this,e,Ye,Ue,G,{squareData:0,squareSize:1,setHighlight:6,setType:7})}get setHighlight(){return this.$$.ctx[6]}get setType(){return this.$$.ctx[7]}}function he(o,e,s){const n=o.slice();return n[8]=e[s],n[9]=e,n[10]=s,n}function de(o,e,s){const n=o.slice();return n[8]=e[s],n[11]=e,n[12]=s,n}function me(o){let e,s=o[10],n=o[12],t;const i=()=>o[6](e,s,n),r=()=>o[6](null,s,n);let c={squareData:{isBlack:o[3](o[10],o[12]),column:o[12],row:o[10]},squareSize:o[0]};return e=new Xe({props:c}),i(),e.$on("square-click",o[7]),{c(){z(e.$$.fragment)},m(l,a){L(e,l,a),t=!0},p(l,a){(s!==l[10]||n!==l[12])&&(r(),s=l[10],n=l[12],i());const d={};a&1&&(d.squareSize=l[0]),e.$set(d)},i(l){t||(S(e.$$.fragment,l),t=!0)},o(l){P(e.$$.fragment,l),t=!1},d(l){r(),R(e,l)}}}function pe(o){let e,s,n,t=Array(o[2].boardData.columns),i=[];for(let c=0;c<t.length;c+=1)i[c]=me(de(o,t,c));const r=c=>P(i[c],1,1,()=>{i[c]=null});return{c(){e=C("div");for(let c=0;c<i.length;c+=1)i[c].c();s=E(),T(e,"class","row svelte-1q7kgo4")},m(c,l){w(c,e,l);for(let a=0;a<i.length;a+=1)i[a].m(e,null);q(e,s),n=!0},p(c,l){if(l&15){t=Array(c[2].boardData.columns);let a;for(a=0;a<t.length;a+=1){const d=de(c,t,a);i[a]?(i[a].p(d,l),S(i[a],1)):(i[a]=me(d),i[a].c(),S(i[a],1),i[a].m(e,s))}for(U(),a=t.length;a<i.length;a+=1)r(a);Y()}},i(c){if(!n){for(let l=0;l<t.length;l+=1)S(i[l]);n=!0}},o(c){i=i.filter(Boolean);for(let l=0;l<i.length;l+=1)P(i[l]);n=!1},d(c){c&&k(e),X(i,c)}}}function Ze(o){let e,s,n=Array(o[2].boardData.rows),t=[];for(let r=0;r<n.length;r+=1)t[r]=pe(he(o,n,r));const i=r=>P(t[r],1,1,()=>{t[r]=null});return{c(){e=C("div");for(let r=0;r<t.length;r+=1)t[r].c();T(e,"class","board svelte-1q7kgo4")},m(r,c){w(r,e,c);for(let l=0;l<t.length;l+=1)t[l].m(e,null);s=!0},p(r,[c]){if(c&15){n=Array(r[2].boardData.rows);let l;for(l=0;l<n.length;l+=1){const a=he(r,n,l);t[l]?(t[l].p(a,c),S(t[l],1)):(t[l]=pe(a),t[l].c(),S(t[l],1),t[l].m(e,null))}for(U(),l=n.length;l<t.length;l+=1)i(l);Y()}},i(r){if(!s){for(let c=0;c<n.length;c+=1)S(t[c]);s=!0}},o(r){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)P(t[c]);s=!1},d(r){r&&k(e),X(t,r)}}}function et(o,e,s){let n;M(o,W,f=>s(2,n=f));let{squareSize:t=5}=e;const i=ae(n.boardData.rows,n.boardData.columns),r=f=>{for(const p of f)i[p.row][p.column].setHighlight(!0)},c=()=>{ce(i,(f,p,m)=>{f.setHighlight(!1)})},l=(f,p)=>f%2?!(p%2):!!(p%2);function a(f,p,m){F[f?"unshift":"push"](()=>{i[p][m]=f,s(1,i)})}function d(f){Pe.call(this,o,f)}return o.$$set=f=>{"squareSize"in f&&s(0,t=f.squareSize)},[t,i,n,l,r,c,a,d]}class tt extends I{constructor(e){super();$(this,e,et,Ze,G,{squareSize:0,highlightSquares:4,clearHighlights:5})}get highlightSquares(){return this.$$.ctx[4]}get clearHighlights(){return this.$$.ctx[5]}}function nt(o){let e,s;return{c(){e=C("p"),s=D(o[0])},m(n,t){w(n,e,t),q(e,s)},p(n,[t]){t&1&&O(s,n[0])},i:A,o:A,d(n){n&&k(e)}}}function st(o,e,s){let n,t;return M(o,W,i=>s(1,t=i)),o.$$.update=()=>{o.$$.dirty&2&&s(0,n=(()=>{if(t.winner===B.White)return"White won! \u{1F389}";if(t.winner===B.Black)return"Black won! \u{1F389}";let i="";return t.turn.color===B.White?i+="White is ":t.turn.color===B.Black&&(i+="Black is "),t.turn.action===N.Card?i+="placing a card...":t.turn.action===N.Piece&&(i+="moving a piece..."),i})())},[n,t]}class ot extends I{constructor(e){super();$(this,e,st,nt,G,{})}}class it{constructor(){v(this,"isSet",!1);v(this,"position");v(this,"validMoves",[])}set(e,s){this.isSet=!0,this.position=e,this.validMoves=oe(s,e)}unset(){this.isSet=!1,this.position=void 0,this.validMoves=[]}}function rt(o){let e,s,n,t,i,r,c,l,a,d={squareSize:3};return t=new tt({props:d}),o[3](t),t.$on("square-click",o[1]),r=new ot({}),{c(){e=C("button"),e.textContent="New Game",s=E(),n=C("div"),z(t.$$.fragment),i=E(),z(r.$$.fragment),T(n,"class","board-container svelte-1gttu0h")},m(f,p){w(f,e,p),w(f,s,p),w(f,n,p),L(t,n,null),w(f,i,p),L(r,f,p),c=!0,l||(a=Q(e,"click",o[2]),l=!0)},p(f,[p]){const m={};t.$set(m)},i(f){c||(S(t.$$.fragment,f),S(r.$$.fragment,f),c=!0)},o(f){P(t.$$.fragment,f),P(r.$$.fragment,f),c=!1},d(f){f&&k(e),f&&k(s),f&&k(n),o[3](null),R(t),f&&k(i),R(r,f),l=!1,a()}}}function lt(o,e,s){let n,t,i;M(o,x,u=>s(4,n=u)),M(o,W,u=>s(5,t=u)),M(o,Z,u=>s(6,i=u));let r;const c=new it,l=()=>{W.update(u=>(u.nextTurn(),u)),n.connected&&i.connectionClient.send({type:"game",data:t.get()},n.connectionId)};i.connectionClient.recievers.push((u,b)=>{b===n.connectionId&&((u==null?void 0:u.type)==="game"?W.update(g=>(g.set(u.data),g)):(u==null?void 0:u.type)==="gameReset"&&x.update(g=>(g.requestNewGame(V.Them),g)))});const a=u=>{c.set(u,t.boardData),r.highlightSquares(c.validMoves)},d=()=>{c.unset(),r.clearHighlights()},f=u=>{if(t.winner!==null||n.connected&&n.myColor!==t.turn.color)return;const{position:b,squareType:g}=u.detail;switch(g){case y.Empty:t.turn.action===N.Card&&(t.boardData.setSquareType(b,y.Card),l()),t.turn.action===N.Piece&&c.isSet&&(He(b,c.validMoves)&&(t.boardData.movePiece(c.position,b),l()),d());break;case y.Card:c.isSet&&d();break;case y.WhitePiece:if(c.isSet&&se.isEqual(c.position,b)){d();break}d(),t.turn.action===N.Piece&&t.turn.color===B.White&&a(b);break;case y.BlackPiece:if(c.isSet&&se.isEqual(c.position,b)){d();break}d(),t.turn.action===N.Piece&&t.turn.color===B.Black&&a(b);break}},p=()=>{if(n.connected){let u;x.update(b=>(u=b.requestNewGame(V.Me),b)),i.connectionClient.send({type:"gameReset",data:null},n.connectionId),u&&(W.update(b=>(b.reset(),b)),i.connectionClient.send({type:"game",data:t.get()},n.connectionId))}else W.update(u=>(u.reset(),u))};function m(u){F[u?"unshift":"push"](()=>{r=u,s(0,r)})}return[r,f,p,m]}class ct extends I{constructor(e){super();$(this,e,lt,rt,G,{})}}function ee(o,...e){if(o.length-1!==e.length)throw"Invalid template literal!";const s=[];for(let n=0;n<e.length;n++){const t=o[n].trim();s.push({color:t,text:e[n]})}return{parts:s}}class at{constructor(e){v(this,"capacity");v(this,"lines");this.capacity=e,this.lines=[]}set(...e){this.lines=e.slice(-this.capacity)}append(...e){this.lines.push(...e),this.lines=this.lines.slice(-this.capacity)}clear(){this.lines=[]}}function ut(o){let e,s=o[0].text+"",n;return{c(){e=C("span"),n=D(s),K(e,"--text-color",o[0].color),T(e,"class","coloredText svelte-1ezy0zi")},m(t,i){w(t,e,i),q(e,n)},p(t,[i]){i&1&&s!==(s=t[0].text+"")&&O(n,s),i&1&&K(e,"--text-color",t[0].color)},i:A,o:A,d(t){t&&k(e)}}}function ft(o,e,s){let{coloredString:n}=e;return o.$$set=t=>{"coloredString"in t&&s(0,n=t.coloredString)},[n]}class ht extends I{constructor(e){super();$(this,e,ft,ut,G,{coloredString:0})}}function ge(o,e,s){const n=o.slice();return n[1]=e[s],n}function _e(o){let e,s;return e=new ht({props:{coloredString:o[1]}}),{c(){z(e.$$.fragment)},m(n,t){L(e,n,t),s=!0},p(n,t){const i={};t&1&&(i.coloredString=n[1]),e.$set(i)},i(n){s||(S(e.$$.fragment,n),s=!0)},o(n){P(e.$$.fragment,n),s=!1},d(n){R(e,n)}}}function dt(o){let e,s,n=o[0].parts,t=[];for(let r=0;r<n.length;r+=1)t[r]=_e(ge(o,n,r));const i=r=>P(t[r],1,1,()=>{t[r]=null});return{c(){for(let r=0;r<t.length;r+=1)t[r].c();e=ne()},m(r,c){for(let l=0;l<t.length;l+=1)t[l].m(r,c);w(r,e,c),s=!0},p(r,[c]){if(c&1){n=r[0].parts;let l;for(l=0;l<n.length;l+=1){const a=ge(r,n,l);t[l]?(t[l].p(a,c),S(t[l],1)):(t[l]=_e(a),t[l].c(),S(t[l],1),t[l].m(e.parentNode,e))}for(U(),l=n.length;l<t.length;l+=1)i(l);Y()}},i(r){if(!s){for(let c=0;c<n.length;c+=1)S(t[c]);s=!0}},o(r){t=t.filter(Boolean);for(let c=0;c<t.length;c+=1)P(t[c]);s=!1},d(r){X(t,r),r&&k(e)}}}function mt(o,e,s){let{coloredText:n}=e;return o.$$set=t=>{"coloredText"in t&&s(0,n=t.coloredText)},[n]}class pt extends I{constructor(e){super();$(this,e,mt,dt,G,{coloredText:0})}}function be(o,e,s){const n=o.slice();return n[14]=e[s],n}function we(o){let e,s,n,t;return s=new pt({props:{coloredText:o[14]}}),{c(){e=C("div"),z(s.$$.fragment),n=E()},m(i,r){w(i,e,r),L(s,e,null),q(e,n),t=!0},p(i,r){const c={};r&2&&(c.coloredText=i[14]),s.$set(c)},i(i){t||(S(s.$$.fragment,i),t=!0)},o(i){P(s.$$.fragment,i),t=!1},d(i){i&&k(e),R(s)}}}function gt(o){let e,s,n,t,i,r,c,l,a,d,f,p,m=o[1].lines,u=[];for(let g=0;g<m.length;g+=1)u[g]=we(be(o,m,g));const b=g=>P(u[g],1,1,()=>{u[g]=null});return{c(){e=C("div"),s=C("div");for(let g=0;g<u.length;g+=1)u[g].c();n=E(),t=C("div"),i=C("pre"),r=D(o[0]),c=E(),l=C("form"),a=C("input"),T(i,"class","prompt svelte-xyhhrb"),T(a,"class","chatInput svelte-xyhhrb"),T(a,"type","text"),T(l,"class","form"),T(t,"class","input svelte-xyhhrb"),T(e,"class","webConsole svelte-xyhhrb")},m(g,h){w(g,e,h),q(e,s);for(let _=0;_<u.length;_+=1)u[_].m(s,null);q(e,n),q(e,t),q(t,i),q(i,r),q(t,c),q(t,l),q(l,a),o[12](a),o[13](e),d=!0,f||(p=[Q(l,"submit",le(o[4])),Q(e,"click",le(o[5]))],f=!0)},p(g,[h]){if(h&2){m=g[1].lines;let _;for(_=0;_<m.length;_+=1){const J=be(g,m,_);u[_]?(u[_].p(J,h),S(u[_],1)):(u[_]=we(J),u[_].c(),S(u[_],1),u[_].m(s,null))}for(U(),_=m.length;_<u.length;_+=1)b(_);Y()}(!d||h&1)&&O(r,g[0])},i(g){if(!d){for(let h=0;h<m.length;h+=1)S(u[h]);d=!0}},o(g){u=u.filter(Boolean);for(let h=0;h<u.length;h+=1)P(u[h]);d=!1},d(g){g&&k(e),X(u,g),o[12](null),o[13](null),f=!1,re(p)}}}function _t(o,e,s){let{promptString:n}=e,{maxLines:t}=e,{commandHandler:i}=e,{inputHandler:r}=e;const c=new at(t);let l,a;const d=(...h)=>{c.set(...h),s(1,c)},f=(...h)=>{c.append(...h),s(1,c)},p=()=>{c.clear(),s(1,c)},m=()=>{const h=a.value.replace(/(\r\n|\n|\r)/gm,"");if(s(3,a.value="",a),f(ee`black${n} grey${h}`),h.charAt(0)==="/"){const[_,...J]=h.slice(1).split(" ");i(_,...J)}else r(h)},u=()=>{a.focus({preventScroll:!0})};Ae(()=>{s(2,l.scrollTop=l.scrollHeight,l)});function b(h){F[h?"unshift":"push"](()=>{a=h,s(3,a)})}function g(h){F[h?"unshift":"push"](()=>{l=h,s(2,l)})}return o.$$set=h=>{"promptString"in h&&s(0,n=h.promptString),"maxLines"in h&&s(6,t=h.maxLines),"commandHandler"in h&&s(7,i=h.commandHandler),"inputHandler"in h&&s(8,r=h.inputHandler)},[n,c,l,a,m,u,t,i,r,d,f,p,b,g]}class bt extends I{constructor(e){super();$(this,e,_t,gt,G,{promptString:0,maxLines:6,commandHandler:7,inputHandler:8,set:9,append:10,clear:11})}get set(){return this.$$.ctx[9]}get append(){return this.$$.ctx[10]}get clear(){return this.$$.ctx[11]}}function wt(o){let e,s,n,t,i,r,c,l,a;t=new Ke({}),r=new ct({});let d={promptString:"-> ",maxLines:50,inputHandler:o[1],commandHandler:o[2]};return l=new bt({props:d}),o[3](l),{c(){e=C("div"),s=C("h1"),s.textContent="Blackout",n=E(),z(t.$$.fragment),i=E(),z(r.$$.fragment),c=E(),z(l.$$.fragment),T(s,"class","svelte-1nt12ac"),T(e,"class","container svelte-1nt12ac")},m(f,p){w(f,e,p),q(e,s),q(e,n),L(t,e,null),q(e,i),L(r,e,null),q(e,c),L(l,e,null),a=!0},p(f,[p]){const m={};l.$set(m)},i(f){a||(S(t.$$.fragment,f),S(r.$$.fragment,f),S(l.$$.fragment,f),a=!0)},o(f){P(t.$$.fragment,f),P(r.$$.fragment,f),P(l.$$.fragment,f),a=!1},d(f){f&&k(e),R(t),R(r),o[3](null),R(l)}}}function kt(o,e,s){let n,t;M(o,x,a=>s(4,n=a)),M(o,Z,a=>s(5,t=a));let i;Ee(()=>{i.set(ee`blue${"Chat"}`),t.connectionClient.recievers.push((a,d)=>{d===n.connectionId&&(a==null?void 0:a.type)==="text"&&i.append(ee`pink ${"<Opponent> "} black${a.data}`)})});const r=a=>{n.connected&&t.connectionClient.send({type:"text",data:a},n.connectionId)},c=(a,...d)=>{switch(a=a.toLowerCase(),a){case"":break;case"clear":case"clr":i.clear();break;default:i.append(ee`red${a} black${": command not found!"}`)}};function l(a){F[a?"unshift":"push"](()=>{i=a,s(0,i)})}return[i,r,c,l]}class vt extends I{constructor(e){super();$(this,e,kt,wt,G,{})}}new vt({target:document.getElementById("app")});
